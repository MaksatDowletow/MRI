# План разработки приложения для описания МРТ снимков

Данный план адаптирован для текущего проекта — одностраничного приложения для формирования структурированных МРТ-отчетов (RSNA/022) на Туркменском языке. Он покрывает ключевые этапы от уточнения требований до сопровождения и учитывает существующую архитектуру (vanilla HTML/CSS/JS, локальное хранение данных, генерация текстовых отчетов и будущий экспорт в DOCX).

## 1. Определение требований
- **Целевая аудитория:** радиологи и медицинские специалисты, а также пациенты, которым нужен понятный итоговый отчет.
- **Функциональные требования:**
  - Аннотация и комментирование полей отчета, включая редактирование врачами.
  - Генерация и экспорт отчетов (plain text → DOCX/PDF) и сохранение истории.
  - Поддержка профилей/пресетов для типовых сценариев обследований.
- **Нефункциональные требования:**
  - Высокая отзывчивость интерфейса при работе с формой и предпросмотром.
  - Надежное хранение черновиков (localStorage → серверное/облачное хранилище).
  - Интуитивный интерфейс с i18n (TM/RU/EN) и поддержкой разных форматов медиа.

## 2. Проектирование системы
- **Архитектура:** клиент-сервер с REST/GraphQL API; фронтенд — статическая SPA на текущем стеке, совместимая с CDN/S3/GitHub Pages; бэкенд — Python (FastAPI/Django) или Node.js (Express) для аутентификации, хранения файлов и логирования.
- **Данные и хранилище:**
  - База для пользователей, ролей и истории отчетов (PostgreSQL/MongoDB).
  - Облачное хранилище для изображений/шаблонов DOCX (S3/GCS); CDN для быстрой выдачи.
  - Логирование аудита действий (ввод, экспорт, скачивание) с последующей аналитикой.
- **ML-интеграция:**
  - Модели для автозаполнения протоколов/шаблонов на основе RSNA; inference-сервис, интегрированный в бэкенд.
  - Конвейер обучения с контролем качества (annotated dataset, метрики точности/recall, калибровка).

## 3. Разработка и интеграция
- **Бэкенд:**
  - Аутентификация/авторизация (JWT, роли «врач», «пациент», «админ»), управление сессиями и ограничением доступа к отчетам.
  - API для CRUD отчетов, загрузки/получения изображений, ведения версий и журналирования событий.
  - Инструменты мониторинга (health checks, метрики, трассировка) и конфигурация CORS для SPA.
- **Фронтенд:**
  - Расширение текущего формы-рендера для аннотаций и комментариев к полям/секциям.
  - Генерация отчетов в DOCX/PDF (на базе существующих модулей `exportDocx.js`, `savePDF.js`) и интерфейс истории версий.
  - Панель профилей/пресетов (использовать `profiles.js`) и перевод интерфейса через `i18n.js`.
- **ML-сервис:**
  - REST/gRPC-вызовы для подсказок по тексту; встраивание в форму с подтверждением пользователя.
  - Кеширование inference-результатов и безопасная работа с PHI.

## 4. Тестирование
- **Юнит-тесты:** покрытие модулей рендеринга формы, генерации отчетов и локального хранилища; тесты API и моделей.
- **Интеграционные тесты:** UI + API (генерация, сохранение, экспорт); проверка совместимости DOCX/PDF.
- **Нагрузочные/перфоманс-тесты:** проверка скорости рендера формы, времени генерации отчетов и отклика ML-сервиса.
- **Тестирование безопасности:** аудит аутентификации, контроль доступа к отчетам и защита данных пациентов (шифрование, журналирование).

## 5. Развертывание
- **Инфраструктура:** контейнеризация (Docker), CI/CD для фронтенда (static hosting) и бэкенда (API + ML-инференс), IaC (Terraform) для облаков.
- **Резервное копирование:** бэкап БД и хранилища изображений; катастрофоустойчивость с поддержкой версий отчетов.
- **Наблюдаемость:** алерты по ошибкам, латентности и доступности API; дашборды для мониторинга пользовательских сценариев.

## 6. Поддержка и эволюция
- **Эксплуатация:** служба поддержки, triage ошибок, SLA/SLI/SLO; план выпуска минорных/мажорных обновлений.
- **Улучшения:** сбор обратной связи (опросы врачей/пациентов), A/B-тесты UI, приоритезация новых функций (например, сегментация изображений, более детальный экспорт RSNA/022).

## 7. Контроль качества документации
- Поддерживать актуальные гайдлайны по аннотациям, формам и шаблонам DOCX.
- Обновлять README с указанием новых сценариев и ссылками на API/ML-сервис.
- Вести отдельный changelog для регламентированных изменений в медицинских протоколах.
